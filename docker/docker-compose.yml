# Docker Compose configuration for Inventory Ware
# 
# This file uses pre-built images from GitHub Container Registry.
# Images are automatically built and published when releases are created.

services:
  pocketbase:
    image: ghcr.io/make-ware/inventory-ware-pocketbase:latest
    restart: unless-stopped
    ports:
      - "8090:8090"
    volumes:
      - data:/data
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-info}
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8090/api/health"]
      interval: 10s
      timeout: 5s
      retries: 5

  webapp:
    image: ghcr.io/make-ware/inventory-ware-webapp:latest
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      # Public URL for the browser to access PocketBase
      - NEXT_PUBLIC_POCKETBASE_URL=${NEXT_PUBLIC_POCKETBASE_URL:-http://localhost:8090}
      # Internal URL for SSR to access PocketBase
      - POCKETBASE_URL=http://pocketbase:8090
    depends_on:
      pocketbase:
        condition: service_healthy

volumes:
  data:
